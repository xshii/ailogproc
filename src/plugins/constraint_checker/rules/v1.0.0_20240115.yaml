# 配置约束规则 v1.0.0
# 创建日期: 2024-01-15
# 描述: 初始版本约束规则

version: "1.0.0"
date: "2024-01-15"
description: "初始版本约束规则"
author: "Team"

# 单组约束：针对单个 top 表配置组
single_constraints:
  - name: "系统模式1的配置约束"
    description: "当 systemMode=1 时的允许和禁止配置"
    when:
      systemMode: "1"
    only_allow:
      debugLevel: ["0", "1", "2"]
      powerMode: ["low", "medium"]
    forbid:
      dangerousFlag: ["1", "true"]

  - name: "调试模式约束"
    description: "高调试级别禁止生产模式"
    when:
      debugLevel: "3"
    forbid:
      productionMode: ["1", "enabled"]

# 多组约束：需要连续2-3个 top 表
multi_constraints:
  - name: "连续两组systemMode一致性"
    description: "连续两个配置的 systemMode 必须相同"
    group_count: 2
    rules:
      - type: "same_value"
        field: "systemMode"

      - type: "conditional"
        when_group: 0
        when_field: "systemMode"
        when_value: "1"
        then_group: 1
        then_field: "powerLevel"
        only_allow: ["5", "10", "15"]
